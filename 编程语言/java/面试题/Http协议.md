# Http协议

## 基本概念

HTTP协议（HyperText Transfer Protocol，超文本传输协议）是因特网上应用最广泛的一种传输协议。 

HTTP是一个基于TCP/IP通信协议来传递数据（HTML文件，图片文件，查询结果等）的协议。

HTTP协议工作于客户端-服务器构架上。浏览器作为HTTP客户端通过URL像HTTP服务端即WEB服务器发送请求。 

HTTP默认端口号为80。

## HTTP协议的主要特点

* HTTP协议是无连接的：不会保持链接，收到请求后响应，然后就断开链接。
* HTTP是无状态的：HTTP是无状态协议，对处理的事务没有记忆力，服务端无法区分客户端的身份。
* HTTP是媒体独立的：只要客户端服务端知道如何处理数据，任何数据都可以通过HTTP协议发送。

## HTTP报文的组成
请求报文: 
- 请求行 
- 请求头 
- 空行 
- 请求体

响应报文 
- 状态行 
- 响应头 
- 空行 
- 响应体

## http 方法
get // 获取资源
post // 传输资源
put // 更新资源
delete // 删除资源
head // 获得报文首部

## post和get的区别：

get在浏览器回退时不会重复提交，post会再次提交请求
get请求会被浏览器主动缓存，post不会，除非手动设置
get请求参数会被完整保留在浏览器历史记录里(因为参数再url里)，post的参数不会被保留
get请求在url中传送的参数有长度限制，post没有限制
get比post更不安全，直接暴露在url上，不能放敏感信息
get通过url传递，post放在request body中

## http状态码

* 1xx: 指示信息-表示请求已接收，继续处理
* 2xx: 成功-表示请求已被成功接收
* 200： ok
* 206： 客户端发送了带range头(表示范围)的get请求，服务器完成了它
* 3xx：重定向-要完成请求必须进行进一步操作
* 301：永久重定向
* 302：临时重定向
* 304：客户端已经缓存了资源可以直接用
* 4xx: 客户端错误-请求语法错误或请求无法实现
* 400：客户端请求语法错误
* 401：请求未经授权
* 403：访问被禁止
* 404：请求资源不存在
* 5xx：服务器错误-服务器未能实现合法请求
* 500：服务器错误，原来缓冲的文档可以继续使用
* 503：请求未完成，服务器临时过载或宕机

## http持久链接

http默认采用“请求-应答”模式，每个请求都跟服务器做一个新的链接，完成之后立即断开连接，所以说是无连接的协议。

http1.1版本增加了Keep-alive模式（持久链接、链接重用）时，Keep-Alive功能使客户端到服务端的链接持续有效，当出现对服务端的后续请求时，Keep-Alive功能避免了建立或重新建立连接。

## 管线化

在持久链接的情况下，某个链接的消息传递类似于：

请求1–>响应1–>请求2–>响应2–>请求3–>响应3

管线化会把它变成下边这样：

请求1–>请求2–>请求3–>响应1–>响应2–>响应3

即把多个请求打包一次传输过去，类似于jquery的$when方法。

## TCP/IP协议组

TCP/IP是个协议组，可分为三个层次：网络层、传输层和应用层。

在网络层有IP协议、ICMP协议、ARP协议、RARP协议和BOOTP协议。

在传输层中有TCP协议与UDP协议。

在应用层有FTP、HTTP、TELNET、SMTP、DNS等协议。

因此，HTTP本身就是一个协议，是从Web服务器传输超文本到本地浏览器的传送协议。 

## HTTP的工作流程

* 地址解析
    * 协议
    * 主机名
    * 端口
    * 请求路径
    * 参数
* 封装HTTP 请求
    封装请求头信息
* 封装 TCP 包
    封装 TCP 数据，建立TCP连接
* 客户端发送请求命令
* 服务器端响应
* 关闭连接
    服务器端在发送完响应之后 , 就会关闭连接 , 如果过客户端的请求的头部信息中有 Connection-alive , 那么客户端在响应完这个请求之后不会关闭连接 , 知道客户端的所有请求都响应完毕 , 才会关闭连接 , 这样大大节省了带宽和 IO 资源 .
    
    